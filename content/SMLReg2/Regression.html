<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Erich Doclaf">
<meta name="dcterms.date" content="2023-06-12">

<title>MyLabJournal - Supervised ML - Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/icons/favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MyLabJournal</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-journal" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Journal</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-journal">    
        <li>
    <a class="dropdown-item" href="../../content/MLFund/01_MLFunds.html" rel="" target="">
 <span class="dropdown-text">Machine Learning Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/SMLReg2/Regression.html" rel="" target="">
 <span class="dropdown-text">Supervised ML - Regression 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/AML1/aml1.html" rel="" target="">
 <span class="dropdown-text">Automated ML 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/AML2/aml2.html" rel="" target="">
 <span class="dropdown-text">Automated ML 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/PM/pmeasures.html" rel="" target="">
 <span class="dropdown-text">Performance Measures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/BBModels/bbmodels.html" rel="" target="">
 <span class="dropdown-text">Black Box Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../content/DL/deepL.html" rel="" target="">
 <span class="dropdown-text">Deep Learning</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../content/02_notes/05_class_notes.html" rel="" target="">
 <span class="menu-text">Class notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../content/03_other/06_links.html" rel="" target="">
 <span class="menu-text">Links</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#challenge-summary" id="toc-challenge-summary" class="nav-link active" data-scroll-target="#challenge-summary"><span class="header-section-number">1</span> Challenge Summary</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">2</span> Libraries</a></li>
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions"><span class="header-section-number">3</span> Helper functions</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">4</span> Data</a>
  <ul class="collapse">
  <li><a href="#data-preparation-feature-engineering" id="toc-data-preparation-feature-engineering" class="nav-link" data-scroll-target="#data-preparation-feature-engineering"><span class="header-section-number">4.1</span> Data Preparation &amp; Feature Engineering</a></li>
  <li><a href="#splitting-the-data" id="toc-splitting-the-data" class="nav-link" data-scroll-target="#splitting-the-data"><span class="header-section-number">4.2</span> Splitting the Data</a></li>
  <li><a href="#recipe" id="toc-recipe" class="nav-link" data-scroll-target="#recipe"><span class="header-section-number">4.3</span> Recipe</a></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">5</span> Linear Regression</a>
  <ul class="collapse">
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1"><span class="header-section-number">5.1</span> Model 1</a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2"><span class="header-section-number">5.2</span> Model 2</a></li>
  </ul></li>
  <li><a href="#glm-regularized-regression" id="toc-glm-regularized-regression" class="nav-link" data-scroll-target="#glm-regularized-regression"><span class="header-section-number">6</span> GLM Regularized Regression</a>
  <ul class="collapse">
  <li><a href="#model-3-glmnet-elastic-net" id="toc-model-3-glmnet-elastic-net" class="nav-link" data-scroll-target="#model-3-glmnet-elastic-net"><span class="header-section-number">6.1</span> Model 3: GLMNET (Elastic Net)</a></li>
  </ul></li>
  <li><a href="#tree-based-methods" id="toc-tree-based-methods" class="nav-link" data-scroll-target="#tree-based-methods"><span class="header-section-number">7</span> Tree-Based Methods</a>
  <ul class="collapse">
  <li><a href="#model-4-decision-trees" id="toc-model-4-decision-trees" class="nav-link" data-scroll-target="#model-4-decision-trees"><span class="header-section-number">7.1</span> Model 4: Decision Trees</a></li>
  <li><a href="#ranger---model-5" id="toc-ranger---model-5" class="nav-link" data-scroll-target="#ranger---model-5"><span class="header-section-number">7.2</span> Ranger - Model 5</a></li>
  <li><a href="#randomforest---model-06" id="toc-randomforest---model-06" class="nav-link" data-scroll-target="#randomforest---model-06"><span class="header-section-number">7.3</span> randomForest - Model 06</a></li>
  <li><a href="#model---xgboost" id="toc-model---xgboost" class="nav-link" data-scroll-target="#model---xgboost"><span class="header-section-number">7.4</span> Model - XGBoost</a></li>
  </ul></li>
  <li><a href="#prediction-evaluation" id="toc-prediction-evaluation" class="nav-link" data-scroll-target="#prediction-evaluation"><span class="header-section-number">8</span> Prediction &amp; Evaluation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Supervised ML - Regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Erich Doclaf </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 12, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="challenge-summary" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Challenge Summary</h1>
<p>In this session we did not use the recipes packages to prepare our data. This is going to be your challenge. For further information take a look at the last session or just use google. Prepare the data for the models with the steps provided below. Remember, you don’t need to set the flags by yourself (see all_nominal()).</p>
</section>
<section id="libraries" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Libraries</h1>
<p>Load the following libraries.</p>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-1_be578f4f68042df6f78d476d5884e751">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("plotly")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(umap)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(ggrepel) <span class="co"># Addon for ggplot, so that the labels do not overlap</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(vip)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(workflows)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># Modeling</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># Preprocessing &amp; Sampling</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(recipes)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu">library</span>(rsample)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># Modeling Error Metrics</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="fu">library</span>(yardstick)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">library</span>(ranger)</span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co"># Plotting Decision Trees</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">library</span>(rpart.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="helper-functions" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Helper functions</h1>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-2_5df9d20ec696ed1a134c0fe610f1ee52">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>plot_ggpairs <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">density_alpha =</span> <span class="fl">0.5</span>) {</span>
<span id="cb2-2"><a href="#cb2-2"></a>  </span>
<span id="cb2-3"><a href="#cb2-3"></a>  color_expr <span class="ot">&lt;-</span> <span class="fu">enquo</span>(color)</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="cf">if</span> (rlang<span class="sc">::</span><span class="fu">quo_is_null</span>(color_expr)) {</span>
<span id="cb2-5"><a href="#cb2-5"></a>    </span>
<span id="cb2-6"><a href="#cb2-6"></a>    g <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>      <span class="fu">ggpairs</span>(<span class="at">lower =</span> <span class="st">"blank"</span>) </span>
<span id="cb2-8"><a href="#cb2-8"></a>    </span>
<span id="cb2-9"><a href="#cb2-9"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-10"><a href="#cb2-10"></a>    </span>
<span id="cb2-11"><a href="#cb2-11"></a>    color_name <span class="ot">&lt;-</span> <span class="fu">quo_name</span>(color_expr)</span>
<span id="cb2-12"><a href="#cb2-12"></a>    g <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>      <span class="fu">ggpairs</span>(<span class="at">mapping =</span> <span class="fu">aes_string</span>(<span class="at">color =</span> color_name), </span>
<span id="cb2-14"><a href="#cb2-14"></a>              <span class="at">lower =</span> <span class="st">"blank"</span>, <span class="at">legend =</span> <span class="dv">1</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>              <span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"densityDiag"</span>, </span>
<span id="cb2-16"><a href="#cb2-16"></a>                                            <span class="at">alpha =</span> density_alpha))) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a>  }</span>
<span id="cb2-19"><a href="#cb2-19"></a>  </span>
<span id="cb2-20"><a href="#cb2-20"></a>  <span class="fu">return</span>(g)</span>
<span id="cb2-21"><a href="#cb2-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data</h1>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-3_b45df35b12607eed0cbe97eda56619a3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Data set</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>bike_orderlines_tbl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"bike_orderlines.rds"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">glimpse</span>(bike_orderlines_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 15,644
#&gt; Columns: 18
#&gt; $ order_id       &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 3, 3, 3, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7…
#&gt; $ order_line     &lt;dbl&gt; 1, 2, 1, 2, 1, 2, 3, 4, 5, 1, 1, 2, 3, 4, 1, 2, 3, 4, 1…
#&gt; $ order_date     &lt;dttm&gt; 2015-01-07, 2015-01-07, 2015-01-10, 2015-01-10, 2015-0…
#&gt; $ model          &lt;chr&gt; "Spectral CF 7 WMN", "Ultimate CF SLX Disc 8.0 ETAP", "…
#&gt; $ model_year     &lt;dbl&gt; 2021, 2020, 2021, 2019, 2020, 2020, 2020, 2021, 2020, 2…
#&gt; $ category_1     &lt;chr&gt; "Mountain", "Road", "Mountain", "Road", "Mountain", "Hy…
#&gt; $ category_2     &lt;chr&gt; "Trail", "Race", "Trail", "Triathlon Bike", "Dirt Jump"…
#&gt; $ category_3     &lt;chr&gt; "Spectral", "Ultimate", "Neuron", "Speedmax", "Stitched…
#&gt; $ price          &lt;dbl&gt; 3119, 5359, 2729, 1749, 1219, 1359, 2529, 1559, 3899, 6…
#&gt; $ quantity       &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1…
#&gt; $ total_price    &lt;dbl&gt; 3119, 5359, 2729, 1749, 1219, 1359, 2529, 1559, 3899, 6…
#&gt; $ frame_material &lt;chr&gt; "carbon", "carbon", "carbon", "carbon", "aluminium", "c…
#&gt; $ weight         &lt;dbl&gt; 13.80, 7.44, 14.06, 8.80, 11.50, 8.80, 8.20, 8.85, 14.4…
#&gt; $ url            &lt;chr&gt; "https://www.canyon.com/en-de/mountain-bikes/trail-bike…
#&gt; $ bikeshop       &lt;chr&gt; "AlexandeRad", "AlexandeRad", "WITT-RAD", "WITT-RAD", "…
#&gt; $ location       &lt;chr&gt; "Hamburg, Hamburg", "Hamburg, Hamburg", "Bremen, Bremen…
#&gt; $ lat            &lt;dbl&gt; 53.57532, 53.57532, 53.07379, 53.07379, 48.78234, 48.78…
#&gt; $ lng            &lt;dbl&gt; 10.015340, 10.015340, 8.826754, 8.826754, 9.180819, 9.1…</code></pre>
</div>
</div>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-4_d41b66a776a9e7d1f0b8628ba512e689">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>model_sales_tbl <span class="ot">&lt;-</span> bike_orderlines_tbl <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="fu">select</span>(total_price, model, category_2, frame_material) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="fu">group_by</span>(model, category_2, frame_material) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="fu">summarise</span>(<span class="at">total_sales =</span> <span class="fu">sum</span>(total_price)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(total_sales))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; `summarise()` has grouped output by 'model', 'category_2'. You can override
#&gt; using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>model_sales_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["category_2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["frame_material"],"name":[3],"type":["chr"],"align":["left"]},{"label":["total_sales"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ultimate CF SLX Disc 9.0 Di2","2":"Race","3":"carbon","4":"1322886"},{"1":"Ultimate CF SLX 9.0 Di2","2":"Race","3":"carbon","4":"1041032"},{"1":"Sender CFR","2":"Downhill","3":"aluminium","4":"926436"},{"1":"Torque CF 9.0","2":"Enduro","3":"carbon","4":"893689"},{"1":"Speedmax WMN CF SLX 8.0 SL","2":"Triathlon Bike","3":"carbon","4":"883099"},{"1":"Endurace CF SLX Disc 9.0 Di2","2":"Endurance","3":"carbon","4":"859194"},{"1":"Speedmax CF SLX 9.0 LTD","2":"Triathlon Bike","3":"carbon","4":"842292"},{"1":"Lux CF SLX 9 LTD","2":"Cross-Country","3":"carbon","4":"811461"},{"1":"Ultimate CF SLX Disc 8.0 ETAP","2":"Race","3":"carbon","4":"777055"},{"1":"Grail:ON CF 7","2":"E-Gravel","3":"carbon","4":"735219"},{"1":"Aeroad CF SL Disc 8.0 ETAP","2":"Race","3":"carbon","4":"714729"},{"1":"Spectral CF 9","2":"Trail","3":"carbon","4":"712130"},{"1":"Ultimate CF SLX 9.0 ETAP","2":"Race","3":"carbon","4":"688446"},{"1":"Neuron:ON WMN 7.0","2":"E-Mountain","3":"aluminium","4":"678492"},{"1":"Spectral WMN CFR 9.0","2":"Trail","3":"carbon","4":"662830"},{"1":"Grail CF SLX 8.0 Di2","2":"Adventure","3":"carbon","4":"662418"},{"1":"Lux CF 8","2":"Cross-Country","3":"carbon","4":"658931"},{"1":"Spectral:ON WMN CF 7.0","2":"E-Mountain","3":"carbon","4":"641685"},{"1":"Speedmax CF 7.0","2":"Triathlon Bike","3":"carbon","4":"609091"},{"1":"Speedmax CF 8.0 Di2","2":"Triathlon Bike","3":"carbon","4":"590236"},{"1":"Spectral:ON CF 7.0","2":"E-Mountain","3":"carbon","4":"587239"},{"1":"Spectral CF 7","2":"Trail","3":"carbon","4":"580881"},{"1":"Ultimate WMN CF SL Disc 8.0 ETAP","2":"Race","3":"carbon","4":"573153"},{"1":"Inflite CF SLX 9","2":"Cyclocross","3":"carbon","4":"567493"},{"1":"Grail:ON CF 8","2":"E-Gravel","3":"carbon","4":"558252"},{"1":"Neuron:ON 8.0","2":"E-Mountain","3":"aluminium","4":"557557"},{"1":"Ultimate CF SLX Disc 9.0 Team Movistar","2":"Race","3":"carbon","4":"556836"},{"1":"Lux CF SLX 9 Team","2":"Cross-Country","3":"carbon","4":"549806"},{"1":"Inflite CF SL 8","2":"Cyclocross","3":"carbon","4":"546669"},{"1":"Speedmax CF 8.0 SL","2":"Triathlon Bike","3":"carbon","4":"537510"},{"1":"Spectral:ON CF 9.0","2":"E-Mountain","3":"carbon","4":"537188"},{"1":"Ultimate CFR Disc Di2","2":"Race","3":"carbon","4":"533448"},{"1":"Sender CFR FMD","2":"Downhill","3":"carbon","4":"522006"},{"1":"Strive CFR","2":"Enduro","3":"aluminium","4":"520561"},{"1":"Neuron CF 9 SL","2":"Trail","3":"carbon","4":"510769"},{"1":"Torque CF 8.0","2":"Enduro","3":"carbon","4":"502971"},{"1":"Pathlite:ON 6.0","2":"E-Trekking","3":"aluminium","4":"500733"},{"1":"Lux CF SL 8.0","2":"Cross-Country","3":"carbon","4":"489464"},{"1":"Speedmax WMN CF 8.0","2":"Triathlon Bike","3":"carbon","4":"483039"},{"1":"Grail CF SL 7","2":"All-Road","3":"carbon","4":"481834"},{"1":"Exceed CFR LTD","2":"Cross-Country","3":"carbon","4":"481764"},{"1":"Aeroad CF SL Disc 8.0 Di2","2":"Race","3":"carbon","4":"480795"},{"1":"Grail CF SL 8 WMN Di2","2":"All-Road","3":"carbon","4":"473851"},{"1":"Ultimate WMN CF SLX Disc 9.0 ETAP","2":"Race","3":"carbon","4":"473769"},{"1":"Spectral:ON CF 8.0","2":"E-Mountain","3":"carbon","4":"467424"},{"1":"Grand Canyon:ON AL 9.0","2":"E-Mountain","3":"aluminium","4":"453333"},{"1":"Spectral CFR 9.0","2":"Trail","3":"carbon","4":"453321"},{"1":"Grail CF SLX 8 Di2","2":"All-Road","3":"carbon","4":"447900"},{"1":"Grail CF SL 8 Di2","2":"All-Road","3":"carbon","4":"446579"},{"1":"Grail CF SL 8.0 ETAP","2":"All-Road","3":"carbon","4":"442898"},{"1":"Endurace WMN CF SL Disc 8.0","2":"Endurance","3":"carbon","4":"439043"},{"1":"Neuron CF 9.0 SL","2":"Trail","3":"carbon","4":"425862"},{"1":"Neuron CF 8","2":"Trail","3":"carbon","4":"422995"},{"1":"Neuron CF 9","2":"Trail","3":"carbon","4":"421689"},{"1":"Neuron 7","2":"Trail","3":"aluminium","4":"409737"},{"1":"Ultimate CF SLX Disc 9.0 ETAP","2":"Race","3":"carbon","4":"407102"},{"1":"Grand Canyon:ON WMN AL 8.0","2":"E-Mountain","3":"aluminium","4":"405741"},{"1":"Endurace CF SL Disc 8.0 Di2","2":"Endurance","3":"carbon","4":"405594"},{"1":"Pathlite:ON 7","2":"E-Trekking","3":"aluminium","4":"403698"},{"1":"Roadlite:ON AL 8.0","2":"E-Fitness","3":"aluminium","4":"399156"},{"1":"Roadlite:ON AL 7.0","2":"E-Fitness","3":"aluminium","4":"395428"},{"1":"Exceed CFR Team","2":"Cross-Country","3":"carbon","4":"394689"},{"1":"Strive CF 8.0","2":"Enduro","3":"carbon","4":"377298"},{"1":"Strive CF 7.0","2":"Enduro","3":"carbon","4":"370713"},{"1":"Speedmax WMN CF 8.0 Di2","2":"Triathlon Bike","3":"carbon","4":"367098"},{"1":"Ultimate WMN CF SL Disc 8.0","2":"Race","3":"carbon","4":"364176"},{"1":"Aeroad CF SLX 9.0 Di2","2":"Race","3":"carbon","4":"359053"},{"1":"Commuter:ON 7","2":"E-City","3":"aluminium","4":"357309"},{"1":"Speedmax WMN CF 8.0 LTD","2":"Triathlon Bike","3":"carbon","4":"356065"},{"1":"Sender 6","2":"Downhill","3":"aluminium","4":"355528"},{"1":"Speedmax CF SLX 8.0 SL","2":"Triathlon Bike","3":"carbon","4":"353694"},{"1":"Spectral 5","2":"Trail","3":"aluminium","4":"352935"},{"1":"Grail:ON CF 7 WMN","2":"E-Gravel","3":"carbon","4":"350568"},{"1":"Aeroad CF SL 7.0","2":"Race","3":"carbon","4":"349657"},{"1":"Endurace CF 8.0","2":"Endurance","3":"carbon","4":"344973"},{"1":"Lux CF SLX 9.0 Team","2":"Cross-Country","3":"carbon","4":"344658"},{"1":"Spectral CF 9.0","2":"Trail","3":"carbon","4":"343882"},{"1":"Aeroad CF SL 8.0","2":"Race","3":"carbon","4":"339480"},{"1":"Neuron:ON 7.0","2":"E-Mountain","3":"aluminium","4":"335637"},{"1":"Endurace WMN CF SL Disc 8.0 Di2","2":"Endurance","3":"carbon","4":"334776"},{"1":"Precede:ON CF 9 ST","2":"E-City","3":"carbon","4":"331092"},{"1":"Endurace CF SL Disc 7.0","2":"Endurance","3":"carbon","4":"329889"},{"1":"Grail CF SLX 8 eTap","2":"All-Road","3":"carbon","4":"329751"},{"1":"Speedmax CF 8.0 LTD","2":"Triathlon Bike","3":"carbon","4":"318942"},{"1":"Ultimate CF SL Disc 8.0 Di2","2":"Race","3":"carbon","4":"315462"},{"1":"Ultimate WMN CF SL Disc 8.0 Di2","2":"Race","3":"carbon","4":"315462"},{"1":"Neuron CF 9 WMN","2":"Trail","3":"carbon","4":"312243"},{"1":"Dude CF 8.0 Trail","2":"Fat Bikes","3":"carbon","4":"310155"},{"1":"Grail 7 WMN","2":"All-Road","3":"aluminium","4":"307824"},{"1":"Endurace WMN AL Disc 7.0","2":"Endurance","3":"aluminium","4":"307123"},{"1":"Commuter Sport 8.0","2":"City","3":"aluminium","4":"302211"},{"1":"Inflite CF SL 7","2":"Cyclocross","3":"carbon","4":"297461"},{"1":"Grail:ON CF 8 eTap","2":"E-Gravel","3":"carbon","4":"292450"},{"1":"Neuron 6","2":"Trail","3":"aluminium","4":"288444"},{"1":"Precede:ON CF 9","2":"E-City","3":"carbon","4":"277533"},{"1":"Endurace CF 7.0","2":"Endurance","3":"carbon","4":"277210"},{"1":"Endurace CF SLX Disc 8.0 ETAP","2":"Endurance","3":"carbon","4":"273309"},{"1":"Neuron AL 6.0","2":"Trail","3":"aluminium","4":"269346"},{"1":"Spectral CF 7 WMN","2":"Trail","3":"carbon","4":"268234"},{"1":"Inflite CF SLX 9 Team","2":"Cyclocross","3":"carbon","4":"258951"},{"1":"Grand Canyon:ON AL 8.0","2":"E-Mountain","3":"aluminium","4":"250371"},{"1":"Endurace CF SLX Disc 9.0 ETAP","2":"Endurance","3":"carbon","4":"248506"},{"1":"Roadlite:ON AL 9.0","2":"E-Fitness","3":"aluminium","4":"245412"},{"1":"Grand Canyon 8 WMN","2":"Trail","3":"aluminium","4":"237825"},{"1":"Precede:ON CF 8 ST","2":"E-City","3":"carbon","4":"234584"},{"1":"Pathlite:ON 9.0","2":"E-Trekking","3":"aluminium","4":"233712"},{"1":"Ultimate CF SLX 8.0 Di2","2":"Race","3":"carbon","4":"233073"},{"1":"Ultimate CF SL Disc 8.0 Di2 Aero","2":"Race","3":"carbon","4":"228984"},{"1":"Spectral CF 8","2":"Trail","3":"carbon","4":"228085"},{"1":"Roadlite CF 9.0 LTD","2":"City","3":"carbon","4":"224763"},{"1":"Strive CF 9.0","2":"Enduro","3":"carbon","4":"224592"},{"1":"Roadlite WMN CF 7.0","2":"City","3":"carbon","4":"216701"},{"1":"Lux CF SLX 9.0","2":"Cross-Country","3":"carbon","4":"209671"},{"1":"Grail 7 1by","2":"All-Road","3":"aluminium","4":"208131"},{"1":"Roadlite CF 7.0","2":"City","3":"carbon","4":"207927"},{"1":"Ultimate WMN CF SL Disc 7.0","2":"Race","3":"carbon","4":"206949"},{"1":"Inflite 5","2":"Cyclocross","3":"aluminium","4":"205788"},{"1":"Aeroad CF SL 8.0 Di2","2":"Race","3":"carbon","4":"196047"},{"1":"Grand Canyon 8","2":"Trail","3":"aluminium","4":"195696"},{"1":"Ultimate CFR Disc EPS","2":"Race","3":"carbon","4":"192918"},{"1":"Precede:ON CF 8","2":"E-City","3":"carbon","4":"192694"},{"1":"Ultimate CF SL 8.0 Di2","2":"Race","3":"carbon","4":"192654"},{"1":"Roadlite AL SL 8.0","2":"City","3":"aluminium","4":"190260"},{"1":"Grand Canyon 9","2":"Trail","3":"aluminium","4":"188892"},{"1":"Exceed CF SLX 9.0 Race LTD","2":"Cross-Country","3":"carbon","4":"184338"},{"1":"Endurace AL Disc 7.0","2":"Endurance","3":"aluminium","4":"182403"},{"1":"Endurace CF SL Disc 8.0 Pro","2":"Endurance","3":"carbon","4":"180114"},{"1":"Grail CF SL 7 WMN","2":"All-Road","3":"carbon","4":"175425"},{"1":"Exceed CF 6","2":"Cross-Country","3":"carbon","4":"175398"},{"1":"Pathlite WMN AL 6.0","2":"Touring","3":"aluminium","4":"175305"},{"1":"Lux CF SLX 9.0 Race Limited","2":"Cross-Country","3":"carbon","4":"175131"},{"1":"Pathlite 7 WMN","2":"Touring","3":"aluminium","4":"173621"},{"1":"Endurace CF SL Disc 8.0","2":"Endurance","3":"carbon","4":"173514"},{"1":"Spectral 6","2":"Trail","3":"aluminium","4":"169443"},{"1":"Exceed CF SLX 9","2":"Cross-Country","3":"carbon","4":"169423"},{"1":"Neuron CF SLX 9","2":"Trail","3":"carbon","4":"169229"},{"1":"Neuron AL 7.0","2":"Trail","3":"aluminium","4":"168981"},{"1":"Pathlite 5","2":"Touring","3":"aluminium","4":"158220"},{"1":"Neuron 7 WMN","2":"Trail","3":"aluminium","4":"156730"},{"1":"Ultimate CF SL 7.0","2":"Race","3":"carbon","4":"155946"},{"1":"Commuter 5.0","2":"City","3":"aluminium","4":"152208"},{"1":"Speedmax CF SLX 9.0 TT","2":"Triathlon Bike","3":"carbon","4":"149073"},{"1":"Stitched 360 Pro","2":"Dirt Jump","3":"aluminium","4":"148718"},{"1":"Roadlite 5","2":"City","3":"aluminium","4":"148010"},{"1":"Speedmax CF SLX 8.0","2":"Triathlon Bike","3":"carbon","4":"143328"},{"1":"Endurace WMN AL Disc 6.0","2":"Endurance","3":"aluminium","4":"138321"},{"1":"Grail 7","2":"All-Road","3":"aluminium","4":"138171"},{"1":"Torque AL 6.0","2":"Enduro","3":"aluminium","4":"136450"},{"1":"Aeroad CF SLX 9.0 SL","2":"Race","3":"carbon","4":"128919"},{"1":"Pathlite:ON 8.0","2":"E-Trekking","3":"aluminium","4":"125037"},{"1":"Endurace AL 6.0","2":"Endurance","3":"aluminium","4":"125001"},{"1":"Endurace WMN AL 7.0","2":"Endurance","3":"aluminium","4":"123914"},{"1":"Neuron WMN AL 7.0","2":"Trail","3":"aluminium","4":"121923"},{"1":"Roadlite 5 WMN","2":"City","3":"aluminium","4":"121524"},{"1":"Torque AL 5.0","2":"Enduro","3":"aluminium","4":"120906"},{"1":"Commuter:ON 7 WMN","2":"E-City","3":"aluminium","4":"115884"},{"1":"Stitched 720","2":"Dirt Jump","3":"aluminium","4":"115434"},{"1":"Grail 6","2":"All-Road","3":"aluminium","4":"113802"},{"1":"Exceed CF 5 WMN","2":"Cross-Country","3":"carbon","4":"109494"},{"1":"Pathlite AL 6.0","2":"Touring","3":"aluminium","4":"109038"},{"1":"Stitched 360","2":"Dirt Jump","3":"aluminium","4":"107770"},{"1":"Lux CF SLX 9","2":"Cross-Country","3":"carbon","4":"107118"},{"1":"Exceed CF 7 WMN","2":"Cross-Country","3":"carbon","4":"105160"},{"1":"Endurace WMN CF SL Disc 7.0","2":"Endurance","3":"carbon","4":"102450"},{"1":"Lux CF 7 WMN","2":"Cross-Country","3":"carbon","4":"102270"},{"1":"Grand Canyon 6","2":"Trail","3":"aluminium","4":"93993"},{"1":"Pathlite:ON 5.0","2":"E-Trekking","3":"aluminium","4":"91044"},{"1":"Ultimate CF SL Disc 8.0","2":"Race","3":"carbon","4":"91044"},{"1":"Pathlite:ON 6","2":"E-Trekking","3":"aluminium","4":"90528"},{"1":"Commuter 3.0","2":"City","3":"aluminium","4":"87890"},{"1":"Aeroad WMN CF SL 8.0","2":"Race","3":"carbon","4":"86913"},{"1":"Speedmax WMN CF 7.0","2":"Triathlon Bike","3":"carbon","4":"85560"},{"1":"Grand Canyon 7 WMN","2":"Trail","3":"aluminium","4":"84168"},{"1":"Ultimate CF SL 8.0","2":"Race","3":"carbon","4":"82843"},{"1":"Dude CF 9.0 Trail","2":"Fat Bikes","3":"carbon","4":"81499"},{"1":"Exceed CF 7","2":"Cross-Country","3":"carbon","4":"81499"},{"1":"Pathlite 6 WMN","2":"Touring","3":"aluminium","4":"81244"},{"1":"Pathlite AL SL 7.0","2":"Touring","3":"aluminium","4":"77327"},{"1":"Lux CF 6","2":"Cross-Country","3":"carbon","4":"72975"},{"1":"Pathlite AL SL 8.0","2":"Touring","3":"aluminium","4":"71337"},{"1":"Roadlite CF 9.0","2":"City","3":"carbon","4":"70917"},{"1":"Roadlite 6 WMN","2":"City","3":"aluminium","4":"69485"},{"1":"Spectral WMN CF 8.0","2":"Trail","3":"carbon","4":"68225"},{"1":"Inflite CF SL 6","2":"Cyclocross","3":"carbon","4":"64170"},{"1":"Grand Canyon 6 WMN","2":"Trail","3":"aluminium","4":"62985"},{"1":"Commuter Sport 5.0","2":"City","3":"aluminium","4":"62930"},{"1":"Endurace WMN AL 6.0","2":"Endurance","3":"aluminium","4":"62016"},{"1":"Speedmax CF SLX 9.0 SL","2":"Triathlon Bike","3":"carbon","4":"57051"},{"1":"Grail 6 WMN","2":"All-Road","3":"aluminium","4":"56901"},{"1":"Pathlite:ON 7.0","2":"E-Trekking","3":"aluminium","4":"56142"},{"1":"Speedmax CF 8.0","2":"Triathlon Bike","3":"carbon","4":"55638"},{"1":"Roadlite AL 7.0","2":"City","3":"aluminium","4":"54945"},{"1":"Lux CF 7","2":"Cross-Country","3":"carbon","4":"51135"},{"1":"Grand Canyon 5","2":"Trail","3":"aluminium","4":"50635"},{"1":"Aeroad CF SL Disc 8.0","2":"Race","3":"carbon","4":"50526"},{"1":"Endurace CF SL Disc 8.0 Aero Di2","2":"Endurance","3":"carbon","4":"50268"},{"1":"Neuron:ON 9.0","2":"E-Mountain","3":"aluminium","4":"48279"},{"1":"Spectral 6 WMN","2":"Trail","3":"aluminium","4":"47058"},{"1":"Lux CF SL 6.0","2":"Cross-Country","3":"carbon","4":"46341"},{"1":"Exceed CF SLX 9.0 Race","2":"Cross-Country","3":"carbon","4":"46079"},{"1":"Grand Canyon Young Hero","2":"Trail","3":"aluminium","4":"45162"},{"1":"Grail CF SL 8","2":"All-Road","3":"carbon","4":"43664"},{"1":"Endurace AL Disc 6.0","2":"Endurance","3":"aluminium","4":"40608"},{"1":"Roadlite CF 8.0","2":"City","3":"carbon","4":"40227"},{"1":"Exceed CF SLX 9.0","2":"Adventure","3":"carbon","4":"39589"},{"1":"Roadlite WMN AL SL 8.0","2":"City","3":"aluminium","4":"39406"},{"1":"Exceed CF SLX 8","2":"Cross-Country","3":"carbon","4":"36090"},{"1":"Neuron 6 WMN","2":"Trail","3":"aluminium","4":"35131"},{"1":"Neuron CF LTD","2":"Trail","3":"carbon","4":"34083"},{"1":"Commuter 6.0","2":"City","3":"aluminium","4":"32978"},{"1":"Pathlite 5 WMN","2":"Touring","3":"aluminium","4":"31644"},{"1":"Grail CF SL 8 eTap","2":"All-Road","3":"carbon","4":"31192"},{"1":"Commuter 8.0","2":"City","3":"aluminium","4":"30407"},{"1":"Commuter 4.0","2":"City","3":"aluminium","4":"29932"},{"1":"Roadlite 6","2":"City","3":"aluminium","4":"28863"},{"1":"Grand Canyon 5 WMN","2":"Trail","3":"aluminium","4":"28044"},{"1":"Aeroad CF SLX Disc 9.0 Di2","2":"Race","3":"carbon","4":"25716"},{"1":"Grand Canyon 7","2":"Trail","3":"aluminium","4":"23380"},{"1":"Exceed CF 5","2":"Cross-Country","3":"carbon","4":"18249"},{"1":"Endurace AL 7.0","2":"Endurance","3":"aluminium","4":"15197"},{"1":"Aeroad CF SLX Disc 9.0 ETAP","2":"Race","3":"carbon","4":"13838"},{"1":"Ultimate CF SL Disc 7.0","2":"Race","3":"carbon","4":"10245"},{"1":"Torque CF 7.0","2":"Enduro","3":"carbon","4":"9657"},{"1":"Roadlite WMN CF 8.0","2":"City","3":"carbon","4":"3898"},{"1":"Endurace:ON 7.0","2":"E-Road","3":"aluminium","4":"2919"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-5_a1c4bfad272acd11b63807fa1f18c920">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>model_sales_tbl <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="fu">mutate</span>(<span class="at">category_2 =</span> <span class="fu">as_factor</span>(category_2) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>               <span class="fu">fct_reorder</span>(total_sales, <span class="at">.fun =</span> max) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>               <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(frame_material, total_sales)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#2c3e50"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    <span class="co">#coord_flip() +</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> category_2) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(<span class="at">scale =</span> <span class="fl">1e-6</span>, <span class="at">suffix =</span> <span class="st">"M"</span>, <span class="at">accuracy =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    tidyquant<span class="sc">::</span><span class="fu">theme_tq</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="fu">labs</span>(</span>
<span id="cb8-13"><a href="#cb8-13"></a>        <span class="at">title =</span> <span class="st">"Total Sales for Each Model"</span>,</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="at">x =</span> <span class="st">"Frame Material"</span>, <span class="at">y =</span> <span class="st">"Revenue"</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Groups with fewer than two data points have been dropped.
#&gt; Groups with fewer than two data points have been dropped.
#&gt; Groups with fewer than two data points have been dropped.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in max(data$density): kein nicht-fehlendes Argument für max; gebe -Inf
#&gt; zurück</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Computation failed in `stat_ydensity()`
#&gt; Caused by error in `$&lt;-.data.frame`:
#&gt; ! Ersetzung hat 1 Zeile, Daten haben 0</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="Regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="data-preparation-feature-engineering" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="data-preparation-feature-engineering"><span class="header-section-number">4.1</span> Data Preparation &amp; Feature Engineering</h2>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-6_cfd5d2495241afe58683392e9cb256ef">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>bike_features_tbl <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"bike_features_tbl.rds"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">glimpse</span>(bike_features_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Rows: 231
#&gt; Columns: 67
#&gt; $ bike_id                     &lt;dbl&gt; 2875, 2873, 2874, 2876, 2877, 2225, 2091, …
#&gt; $ model                       &lt;chr&gt; "Aeroad CF SL Disc 8.0 Di2", "Aeroad CF SL…
#&gt; $ model_year                  &lt;dbl&gt; 2020, 2020, 2020, 2020, 2020, 2019, 2019, …
#&gt; $ frame_material              &lt;chr&gt; "carbon", "carbon", "carbon", "carbon", "c…
#&gt; $ weight                      &lt;dbl&gt; 7.60, 7.27, 7.10, 7.73, 7.83, 6.80, 6.80, …
#&gt; $ price                       &lt;dbl&gt; 4579, 6919, 6429, 5069, 3609, 6139, 5359, …
#&gt; $ category_1                  &lt;chr&gt; "Road", "Road", "Road", "Road", "Road", "R…
#&gt; $ category_2                  &lt;chr&gt; "Race", "Race", "Race", "Race", "Race", "R…
#&gt; $ category_3                  &lt;chr&gt; "Aeroad", "Aeroad", "Aeroad", "Aeroad", "A…
#&gt; $ gender                      &lt;chr&gt; "unisex", "unisex", "unisex", "unisex", "u…
#&gt; $ url                         &lt;chr&gt; "https://www.canyon.com/en-de/road-bikes/r…
#&gt; $ Frame                       &lt;chr&gt; "Canyon Aeroad CF SL Disc", "Canyon Aeroad…
#&gt; $ Fork                        &lt;chr&gt; "Canyon FK0041 CF SLX Disc", "Canyon FK004…
#&gt; $ `Rear Derailleur`           &lt;chr&gt; "Shimano Ultegra Di2 R8050 SS", "SRAM RED …
#&gt; $ `Front Derailleur`          &lt;chr&gt; "Shimano Ultegra Di2 R8050", "SRAM RED eTa…
#&gt; $ Cassette                    &lt;chr&gt; "Shimano Ultegra R8000, 11-speed, 11-28T",…
#&gt; $ Crank                       &lt;chr&gt; "Shimano Ultegra R8000", "SRAM RED D1", "S…
#&gt; $ `Bottom bracket`            &lt;chr&gt; "Shimano Pressfit BB72", "SRAM Pressfit RE…
#&gt; $ `Thru Axle`                 &lt;chr&gt; "Canyon Thru Axle", "Canyon Thru Axle", "C…
#&gt; $ Cockpit                     &lt;chr&gt; "Canyon H36 Aerocockpit CF", "Canyon H36 A…
#&gt; $ Saddle                      &lt;chr&gt; "Selle Italia SLR", "Selle Italia SLR", "S…
#&gt; $ Seatpost                    &lt;chr&gt; "Canyon S27 Aero VCLS CF", "Canyon S27 Aer…
#&gt; $ Pedals                      &lt;chr&gt; "None included", "None included", "None in…
#&gt; $ `Derailleur hanger`         &lt;chr&gt; "Shop Derailleur Hanger GP0211-01", "Shop …
#&gt; $ Battery                     &lt;chr&gt; "", "SRAM eTap Powerpack", "", "SRAM eTap …
#&gt; $ Brake                       &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Shift Lever`               &lt;chr&gt; "", "", "", "", "", "", "Shimano Di2 Remot…
#&gt; $ Chain                       &lt;chr&gt; "", "", "", "", "", "", "Shimano CN-HG901 …
#&gt; $ Stem                        &lt;chr&gt; "", "", "", "", "", "", "", "Canyon V13", …
#&gt; $ Handlebar                   &lt;chr&gt; "", "", "", "", "", "", "", "Canyon H16 Ae…
#&gt; $ Headset                     &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Motor                       &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Battery Charger`           &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Flat Pedals`               &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Chainguard                  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Aero Bar`                  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Brake Lever / Master`      &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Wheel Tire System`         &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Suspension Fork`           &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Disc Brake`                &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Grips                       &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Chainring                   &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Display                     &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Modeswitch                  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Rear Shock`                &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Light                       &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ Fender                      &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Bike Racks`                &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Brake 1`                   &lt;chr&gt; "", "", "", "", "", "SRAM S-900 Direct Mou…
#&gt; $ `Brake 2`                   &lt;chr&gt; "", "", "", "", "", "SRAM S-900 Direct Mou…
#&gt; $ `Shift-/ Brake Lever 1`     &lt;chr&gt; "Shimano Ultegra Di2 R8070, 11-speed", "SR…
#&gt; $ `Shift-/ Brake Lever 2`     &lt;chr&gt; "Shimano Ultegra Di2 R8070, 11-speed", "SR…
#&gt; $ `Wheel 1`                   &lt;chr&gt; "DT Swiss ARC 1400 Dicut", "DT Swiss ARC 1…
#&gt; $ `Wheel 2`                   &lt;chr&gt; "DT Swiss ARC 1400 Dicut", "DT Swiss ARC 1…
#&gt; $ `Tyre 1`                    &lt;chr&gt; "Continental Grand Prix 5000 / Attack  23 …
#&gt; $ `Tyre 2`                    &lt;chr&gt; "Continental Grand Prix 5000, 25 mm", "Con…
#&gt; $ `Handlebar Tape 1`          &lt;chr&gt; "Canyon Ergospeed Gel", "Canyon Ergospeed …
#&gt; $ `Handlebar Tape 2`          &lt;chr&gt; "Canyon bar-end plug", "Canyon bar-end plu…
#&gt; $ `Manuals and Accessories 1` &lt;chr&gt; "Canyon tool case", "Canyon tool case", "C…
#&gt; $ `Manuals and Accessories 2` &lt;chr&gt; "DT Swiss warranty &amp; intended use manual",…
#&gt; $ `Manuals and Accessories 3` &lt;chr&gt; "Canyon starter box", "Canyon starter box"…
#&gt; $ `Manuals and Accessories 4` &lt;chr&gt; "", "", "", "", "", "", "", "", "", "BAG R…
#&gt; $ `Manuals and Accessories 5` &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Manuals and Accessories 6` &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Manuals and Accessories 7` &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Manuals and Accessories 8` &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", ""…
#&gt; $ `Brake Rotor`               &lt;list&gt; "Shimano RT800", "SRAM Centerline X", "Sh…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bike_features_tbl <span class="ot">&lt;-</span> bike_features_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="fu">select</span>(model<span class="sc">:</span>url, <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span>, <span class="st">`</span><span class="at">Shift Lever</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="fu">mutate</span>(</span>
<span id="cb14-4"><a href="#cb14-4"></a>      <span class="st">`</span><span class="at">shimano dura-ace</span><span class="st">`</span>        <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano dura-ace "</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-5"><a href="#cb14-5"></a>      <span class="st">`</span><span class="at">shimano ultegra</span><span class="st">`</span>         <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano ultegra "</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-6"><a href="#cb14-6"></a>      <span class="st">`</span><span class="at">shimano 105</span><span class="st">`</span>             <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano 105 "</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-7"><a href="#cb14-7"></a>      <span class="st">`</span><span class="at">shimano tiagra</span><span class="st">`</span>          <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano tiagra "</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-8"><a href="#cb14-8"></a>      <span class="st">`</span><span class="at">Shimano sora</span><span class="st">`</span>            <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano sora"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-9"><a href="#cb14-9"></a>      <span class="st">`</span><span class="at">shimano deore</span><span class="st">`</span>           <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano deore(?! xt)"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-10"><a href="#cb14-10"></a>      <span class="st">`</span><span class="at">shimano slx</span><span class="st">`</span>             <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano slx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-11"><a href="#cb14-11"></a>      <span class="st">`</span><span class="at">shimano grx</span><span class="st">`</span>             <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano grx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-12"><a href="#cb14-12"></a>      <span class="st">`</span><span class="at">Shimano xt</span><span class="st">`</span>              <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano deore xt |shimano xt "</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-13"><a href="#cb14-13"></a>      <span class="st">`</span><span class="at">Shimano xtr</span><span class="st">`</span>             <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano xtr"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-14"><a href="#cb14-14"></a>      <span class="st">`</span><span class="at">Shimano saint</span><span class="st">`</span>           <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano saint"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-15"><a href="#cb14-15"></a>      <span class="st">`</span><span class="at">SRAM red</span><span class="st">`</span>                <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram red"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-16"><a href="#cb14-16"></a>      <span class="st">`</span><span class="at">SRAM force</span><span class="st">`</span>              <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram force"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-17"><a href="#cb14-17"></a>      <span class="st">`</span><span class="at">SRAM rival</span><span class="st">`</span>              <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram rival"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-18"><a href="#cb14-18"></a>      <span class="st">`</span><span class="at">SRAM apex</span><span class="st">`</span>               <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram apex"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-19"><a href="#cb14-19"></a>      <span class="st">`</span><span class="at">SRAM xx1</span><span class="st">`</span>                <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram xx1"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-20"><a href="#cb14-20"></a>      <span class="st">`</span><span class="at">SRAM x01</span><span class="st">`</span>                <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram x01|sram xo1"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-21"><a href="#cb14-21"></a>      <span class="st">`</span><span class="at">SRAM gx</span><span class="st">`</span>                 <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram gx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-22"><a href="#cb14-22"></a>      <span class="st">`</span><span class="at">SRAM nx</span><span class="st">`</span>                 <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram nx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-23"><a href="#cb14-23"></a>      <span class="st">`</span><span class="at">SRAM sx</span><span class="st">`</span>                 <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram sx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-24"><a href="#cb14-24"></a>      <span class="st">`</span><span class="at">SRAM sx</span><span class="st">`</span>                 <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"sram sx"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-25"><a href="#cb14-25"></a>      <span class="st">`</span><span class="at">Campagnolo potenza</span><span class="st">`</span>      <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"campagnolo potenza"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-26"><a href="#cb14-26"></a>      <span class="st">`</span><span class="at">Campagnolo super record</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span> <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"campagnolo super record"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-27"><a href="#cb14-27"></a>      <span class="st">`</span><span class="at">shimano nexus</span><span class="st">`</span>           <span class="ot">=</span> <span class="st">`</span><span class="at">Shift Lever</span><span class="st">`</span>     <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano nexus"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb14-28"><a href="#cb14-28"></a>      <span class="st">`</span><span class="at">shimano alfine</span><span class="st">`</span>          <span class="ot">=</span> <span class="st">`</span><span class="at">Shift Lever</span><span class="st">`</span>     <span class="sc">%&gt;%</span> <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span> <span class="fu">str_detect</span>(<span class="st">"shimano alfine"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb14-29"><a href="#cb14-29"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-30"><a href="#cb14-30"></a>  <span class="co"># Remove original columns  </span></span>
<span id="cb14-31"><a href="#cb14-31"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Rear Derailleur</span><span class="st">`</span>, <span class="st">`</span><span class="at">Shift Lever</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-32"><a href="#cb14-32"></a>  <span class="co"># Set all NAs to 0</span></span>
<span id="cb14-33"><a href="#cb14-33"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">replace</span>(., <span class="fu">is.na</span>(.), <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Reordering and tidying</p>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-7_1ca8883361d395fcfe065e946fa8c274">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># 2.0 TRAINING &amp; </span><span class="al">TEST</span><span class="co"> SETS ----</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>bike_features_tbl <span class="ot">&lt;-</span> bike_features_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5"></a>  </span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">select</span>(id, <span class="fu">everything</span>(), <span class="sc">-</span>url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="splitting-the-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="splitting-the-data"><span class="header-section-number">4.2</span> Splitting the Data</h2>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-8_d048d2ad240cc961b4e393296732e5e2">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>bike_features_tbl <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(category_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["category_2"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Race"},{"1":"Endurance"},{"1":"E-Road"},{"1":"Cyclocross"},{"1":"Triathlon Bike"},{"1":"Fat Bikes"},{"1":"Cross-Country"},{"1":"Adventure"},{"1":"All-Road"},{"1":"E-Gravel"},{"1":"Trail"},{"1":"E-Mountain"},{"1":"Downhill"},{"1":"Dirt Jump"},{"1":"Enduro"},{"1":"E-City"},{"1":"E-Trekking"},{"1":"E-Fitness"},{"1":"City"},{"1":"Touring"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># run both following commands at the same time</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">1337</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>split_obj <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(bike_features_tbl, <span class="at">prop   =</span> <span class="fl">0.80</span>, </span>
<span id="cb17-4"><a href="#cb17-4"></a>                                                       <span class="at">strata =</span> <span class="st">"category_2"</span>)</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># Check if testing contains all category_2 values</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>split_obj <span class="sc">%&gt;%</span> <span class="fu">training</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(category_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["category_2"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Race"},{"1":"Endurance"},{"1":"Cyclocross"},{"1":"Triathlon Bike"},{"1":"Fat Bikes"},{"1":"Cross-Country"},{"1":"Adventure"},{"1":"All-Road"},{"1":"E-Gravel"},{"1":"E-Mountain"},{"1":"Downhill"},{"1":"Dirt Jump"},{"1":"Enduro"},{"1":"E-Trekking"},{"1":"E-City"},{"1":"City"},{"1":"Touring"},{"1":"E-Road"},{"1":"Trail"},{"1":"E-Fitness"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>split_obj <span class="sc">%&gt;%</span> <span class="fu">testing</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(category_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["category_2"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Race"},{"1":"Endurance"},{"1":"Cyclocross"},{"1":"Triathlon Bike"},{"1":"Cross-Country"},{"1":"All-Road"},{"1":"E-Gravel"},{"1":"Trail"},{"1":"E-Mountain"},{"1":"Enduro"},{"1":"E-Trekking"},{"1":"E-Fitness"},{"1":"City"},{"1":"Touring"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Assign training and test data</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>train_tbl <span class="ot">&lt;-</span> <span class="fu">training</span>(split_obj)</span>
<span id="cb19-3"><a href="#cb19-3"></a>test_tbl  <span class="ot">&lt;-</span> <span class="fu">testing</span>(split_obj) </span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co"># We have to remove spaces and dashes from the column names</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>train_tbl <span class="ot">&lt;-</span> train_tbl <span class="sc">%&gt;%</span> <span class="fu">set_names</span>(<span class="fu">str_replace_all</span>(<span class="fu">names</span>(train_tbl), <span class="st">" |-"</span>, <span class="st">"_"</span>))</span>
<span id="cb19-7"><a href="#cb19-7"></a>test_tbl  <span class="ot">&lt;-</span> test_tbl  <span class="sc">%&gt;%</span> <span class="fu">set_names</span>(<span class="fu">str_replace_all</span>(<span class="fu">names</span>(test_tbl),  <span class="st">" |-"</span>, <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="recipe" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="recipe"><span class="header-section-number">4.3</span> Recipe</h2>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-9_f08458f74b74bea4df7a325b9388f126">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>bike_rec <span class="ot">&lt;-</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">recipe</span>(price <span class="sc">~</span> ., <span class="at">data =</span> train_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">step_rm</span>(id, model, model_year, gender, category_1, category_3) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>(), <span class="at">one_hot =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">step_zv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="linear-regression" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Linear Regression</h1>
<section id="model-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="model-1"><span class="header-section-number">5.1</span> Model 1</h2>
<section id="model" class="level3">
<h3 class="anchored" data-anchor-id="model">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-10_22352da06e9076a02375d4ff8d3dcd3f">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># 3.0 LINEAR METHODS ----</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># 3.1 LINEAR REGRESSION - NO ENGINEERED FEATURES ----</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co"># 3.1.1 Model ----</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>model_01_model <span class="ot">&lt;-</span> </span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">linear_reg</span>(<span class="at">mode =</span> <span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a>model_01_workflow <span class="ot">&lt;-</span> </span>
<span id="cb21-10"><a href="#cb21-10"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  <span class="fu">add_model</span>(model_01_model) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a>model_01_linear_lm_simple <span class="ot">&lt;-</span> </span>
<span id="cb21-15"><a href="#cb21-15"></a>  model_01_workflow <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb21-17"><a href="#cb21-17"></a></span>
<span id="cb21-18"><a href="#cb21-18"></a>model_01_linear_lm_simple <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>    <span class="fu">predict</span>(<span class="at">new_data =</span> test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>    <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21"></a>    yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in predict.lm(object = object$fit, newdata = new_data, type =
#&gt; "response"): prediction from rank-deficient fit; attr(*, "non-estim") has
#&gt; doubtful cases</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"728.0513341"},{"1":"rsq","2":"standard","3":"0.8627524"},{"1":"mae","2":"standard","3":"537.1057609"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-11_fe11687dacc71798a848c010ed12e21a">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># tidy() function is applicable for objects with class "lm"</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>model_01_linear_lm_simple <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">pull_workflow_fit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">arrange</span>(p.value) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">as_factor</span>(term) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  </span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#2dc6d6"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(estimate, <span class="at">accuracy =</span> <span class="dv">1</span>, <span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">prefix =</span> <span class="st">""</span>)),</span>
<span id="cb23-11"><a href="#cb23-11"></a>                            <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"#272A36"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">prefix =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Regression: Feature Importance"</span>,</span>
<span id="cb23-14"><a href="#cb23-14"></a>       <span class="at">subtitle =</span> <span class="st">"Model 01: Simple lm Model"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: `pull_workflow_fit()` was deprecated in workflows 0.2.3.
#&gt; ℹ Please use `extract_fit_parsnip()` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Removed 5 rows containing missing values (`geom_label_repel()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: ggrepel: 2 unlabeled data points (too many overlaps). Consider
#&gt; increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="Regression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-12_4778b67b1d415e4d777af14a6c88fbdf">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># 3.1.3 Function to Calculate Metrics ----</span></span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co"># Code we used earlier</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>model_01_linear_lm_simple <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="fu">predict</span>(<span class="at">new_data =</span> test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>    yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in predict.lm(object = object$fit, newdata = new_data, type =
#&gt; "response"): prediction from rank-deficient fit; attr(*, "non-estim") has
#&gt; doubtful cases</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"728.0513341"},{"1":"rsq","2":"standard","3":"0.8627524"},{"1":"mae","2":"standard","3":"537.1057609"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Generalized into a function</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>calc_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(model, <span class="at">new_data =</span> test_tbl) {</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a>    model <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>        <span class="fu">predict</span>(<span class="at">new_data =</span> new_data) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6"></a></span>
<span id="cb30-7"><a href="#cb30-7"></a>        <span class="fu">bind_cols</span>(new_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>        yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred_res)</span>
<span id="cb30-9"><a href="#cb30-9"></a></span>
<span id="cb30-10"><a href="#cb30-10"></a>}</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a>model_01_linear_lm_simple <span class="sc">%&gt;%</span> <span class="fu">calc_metrics</span>(test_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in predict.lm(object = object$fit, newdata = new_data, type =
#&gt; "response"): prediction from rank-deficient fit; attr(*, "non-estim") has
#&gt; doubtful cases</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"728.0513341"},{"1":"rsq","2":"standard","3":"0.8627524"},{"1":"mae","2":"standard","3":"537.1057609"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="model-2" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="model-2"><span class="header-section-number">5.2</span> Model 2</h2>
<section id="model-3" class="level3">
<h3 class="anchored" data-anchor-id="model-3">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-13_00c62c122544b0210d0bc102ae84f6c7">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># 3.2 LINEAR REGRESSION - WITH ENGINEERED FEATURES ----</span></span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co"># 3.2.1 Model ----</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>model_02_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a>model_02_workflow <span class="ot">&lt;-</span> </span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">add_model</span>(model_02_model) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb32-11"><a href="#cb32-11"></a></span>
<span id="cb32-12"><a href="#cb32-12"></a>model_02_linear_lm_complex <span class="ot">&lt;-</span> </span>
<span id="cb32-13"><a href="#cb32-13"></a>  model_02_workflow <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb32-15"><a href="#cb32-15"></a></span>
<span id="cb32-16"><a href="#cb32-16"></a>model_02_linear_lm_complex <span class="sc">%&gt;%</span> <span class="fu">calc_metrics</span>(test_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in predict.lm(object = object$fit, newdata = new_data, type =
#&gt; "response"): prediction from rank-deficient fit; attr(*, "non-estim") has
#&gt; doubtful cases</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"728.0513341"},{"1":"rsq","2":"standard","3":"0.8627524"},{"1":"mae","2":"standard","3":"537.1057609"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation-1" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-1">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-14_ed2b707b9d907d868632e429504cb6d4">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># 3.2.2 Feature importance ----</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>model_02_linear_lm_complex <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">pull_workflow_fit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">arrange</span>(p.value) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">as_factor</span>(term) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  </span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#2dc6d6"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(estimate, <span class="at">accuracy =</span> <span class="dv">1</span>, <span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">prefix =</span> <span class="st">""</span>)),</span>
<span id="cb34-11"><a href="#cb34-11"></a>                            <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"#272A36"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(<span class="at">suffix =</span> <span class="st">" €"</span>, <span class="at">prefix =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Regression: Feature Importance"</span>,</span>
<span id="cb34-14"><a href="#cb34-14"></a>       <span class="at">subtitle =</span> <span class="st">"Model 02: Complex lm Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Removed 5 rows containing missing values (`geom_label_repel()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: ggrepel: 2 unlabeled data points (too many overlaps). Consider
#&gt; increasing max.overlaps</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="Regression_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="glm-regularized-regression" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> GLM Regularized Regression</h1>
<section id="model-3-glmnet-elastic-net" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="model-3-glmnet-elastic-net"><span class="header-section-number">6.1</span> Model 3: GLMNET (Elastic Net)</h2>
<section id="model-4" class="level3">
<h3 class="anchored" data-anchor-id="model-4">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-15_eee7e5bba1d670d7c633f517da26c77b">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># 3.3 PENALIZED REGRESSION ----</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co"># 3.3.1 Model ----</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>model_03_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mode    =</span> <span class="st">"regression"</span>, </span>
<span id="cb38-5"><a href="#cb38-5"></a>             <span class="at">penalty =</span> <span class="dv">10</span>, </span>
<span id="cb38-6"><a href="#cb38-6"></a>             <span class="at">mixture =</span> <span class="fl">0.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a>model_03_workflow <span class="ot">&lt;-</span> </span>
<span id="cb38-10"><a href="#cb38-10"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>  <span class="fu">add_model</span>(model_03_model) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb38-13"><a href="#cb38-13"></a></span>
<span id="cb38-14"><a href="#cb38-14"></a>model_03_linear_glmnet <span class="ot">&lt;-</span> </span>
<span id="cb38-15"><a href="#cb38-15"></a>  model_03_workflow <span class="sc">%&gt;%</span></span>
<span id="cb38-16"><a href="#cb38-16"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb38-17"><a href="#cb38-17"></a></span>
<span id="cb38-18"><a href="#cb38-18"></a>model_03_linear_glmnet <span class="sc">%&gt;%</span> </span>
<span id="cb38-19"><a href="#cb38-19"></a>  <span class="fu">predict</span>(test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>  <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb38-21"><a href="#cb38-21"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"720.1502477"},{"1":"rsq","2":"standard","3":"0.8695072"},{"1":"mae","2":"standard","3":"535.0158763"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation-2" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-2">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-16_9648075e560f18f1a42de37f6b69b0a2">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># 3.3.2 Feature Importance ----</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>model_03_linear_glmnet <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>    <span class="fu">pull_workflow_fit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>    </span>
<span id="cb39-6"><a href="#cb39-6"></a>    <span class="co"># No p value here</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(estimate))) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">as_factor</span>(term) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9"></a></span>
<span id="cb39-10"><a href="#cb39-10"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">dollar</span>(estimate, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb39-13"><a href="#cb39-13"></a>                              <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Regression: Feature Importance"</span>,</span>
<span id="cb39-16"><a href="#cb39-16"></a>         <span class="at">subtitle =</span> <span class="st">"Model 03: GLMNET Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="Regression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="tree-based-methods" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Tree-Based Methods</h1>
<section id="model-4-decision-trees" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="model-4-decision-trees"><span class="header-section-number">7.1</span> Model 4: Decision Trees</h2>
<section id="model-5" class="level3">
<h3 class="anchored" data-anchor-id="model-5">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-17_f4f20bc6e6a67b55da7ac86981d58dbd">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># 4.0 TREE-BASED METHODS ----</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co"># 4.1 DECISION TREES ----</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co"># 4.1.1 Model ----</span></span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a>model_04_model <span class="ot">&lt;-</span> </span>
<span id="cb40-6"><a href="#cb40-6"></a>  <span class="fu">decision_tree</span>(<span class="at">mode =</span> <span class="st">"regression"</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>              </span>
<span id="cb40-8"><a href="#cb40-8"></a>              <span class="co"># Set the values accordingly to get started</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>              <span class="at">cost_complexity =</span> <span class="fl">0.001</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>              <span class="at">tree_depth      =</span> <span class="dv">5</span>,</span>
<span id="cb40-11"><a href="#cb40-11"></a>              <span class="at">min_n           =</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="fu">set_engine</span>(<span class="st">"rpart"</span>)</span>
<span id="cb40-13"><a href="#cb40-13"></a></span>
<span id="cb40-14"><a href="#cb40-14"></a>model_04_workflow <span class="ot">&lt;-</span> </span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>  <span class="fu">add_model</span>(model_04_model) <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb40-18"><a href="#cb40-18"></a></span>
<span id="cb40-19"><a href="#cb40-19"></a>model_04_tree_decision_tree <span class="ot">&lt;-</span> </span>
<span id="cb40-20"><a href="#cb40-20"></a>  model_04_workflow <span class="sc">%&gt;%</span></span>
<span id="cb40-21"><a href="#cb40-21"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb40-22"><a href="#cb40-22"></a></span>
<span id="cb40-23"><a href="#cb40-23"></a>model_04_tree_decision_tree <span class="sc">%&gt;%</span> </span>
<span id="cb40-24"><a href="#cb40-24"></a>  <span class="fu">predict</span>(test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25"></a>  <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"1234.7612319"},{"1":"rsq","2":"standard","3":"0.5731273"},{"1":"mae","2":"standard","3":"929.5638298"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation-3" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-3">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-18_d488c033de84d9130cd620a0cf50bdd4">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">pull_workflow_fit</span>(model_04_tree_decision_tree)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>    <span class="fu">rpart.plot</span>(<span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="Regression_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Optimze plot</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">pull_workflow_fit</span>(model_04_tree_decision_tree)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>    <span class="fu">rpart.plot</span>(</span>
<span id="cb42-4"><a href="#cb42-4"></a>        <span class="at">roundint =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>        <span class="at">type =</span> <span class="dv">1</span>,</span>
<span id="cb42-6"><a href="#cb42-6"></a>        <span class="at">extra =</span> <span class="dv">101</span>, <span class="co"># see help page</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>        <span class="at">fallen.leaves =</span> <span class="cn">FALSE</span>, <span class="co"># changes the angles from 90 to 45-degree</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>        <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="co"># font size</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>        <span class="at">main =</span> <span class="st">"Model 04: Decision Tree"</span>, <span class="co"># Adds title</span></span>
<span id="cb42-10"><a href="#cb42-10"></a>        <span class="at">box.palette =</span> <span class="st">"Blues"</span></span>
<span id="cb42-11"><a href="#cb42-11"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-18-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="Regression_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">show.prp.palettes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-18-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="Regression_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ranger---model-5" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="ranger---model-5"><span class="header-section-number">7.2</span> Ranger - Model 5</h2>
<section id="model-6" class="level3">
<h3 class="anchored" data-anchor-id="model-6">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-19_0b967ed9d06fe9a084fc0ab5b3e959af">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># 4.2 RANDOM FOREST ----</span></span>
<span id="cb44-2"><a href="#cb44-2"></a></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co"># 4.2.1 Model: ranger ----</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">library</span>(ranger)</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a>model_05_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb44-7"><a href="#cb44-7"></a>      <span class="at">mode =</span> <span class="st">"regression"</span>, <span class="at">mtry =</span> <span class="dv">8</span>, <span class="at">trees =</span> <span class="dv">5000</span>, <span class="at">min_n =</span> <span class="dv">10</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="fu">set_engine</span>(<span class="st">"ranger"</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">splitrule =</span> <span class="st">"extratrees"</span>, <span class="at">importance =</span> <span class="st">"impurity"</span>)</span>
<span id="cb44-10"><a href="#cb44-10"></a></span>
<span id="cb44-11"><a href="#cb44-11"></a>model_05_workflow <span class="ot">&lt;-</span> </span>
<span id="cb44-12"><a href="#cb44-12"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>  <span class="fu">add_model</span>(model_05_model) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb44-15"><a href="#cb44-15"></a></span>
<span id="cb44-16"><a href="#cb44-16"></a>model_05_rand_forest_ranger <span class="ot">&lt;-</span> </span>
<span id="cb44-17"><a href="#cb44-17"></a>  model_05_workflow <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="#cb44-18"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb44-19"><a href="#cb44-19"></a></span>
<span id="cb44-20"><a href="#cb44-20"></a>model_05_rand_forest_ranger <span class="sc">%&gt;%</span> </span>
<span id="cb44-21"><a href="#cb44-21"></a>  <span class="fu">predict</span>(test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22"></a>  <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb44-23"><a href="#cb44-23"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"891.7227652"},{"1":"rsq","2":"standard","3":"0.8218191"},{"1":"mae","2":"standard","3":"698.9342293"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation-4" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-4">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-20_960cc8ee0dc21b0f0f6e95d212b29695">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># 4.2.2 ranger: Feature Importance ----</span></span>
<span id="cb45-2"><a href="#cb45-2"></a></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="fu">pull_workflow_fit</span>(model_05_rand_forest_ranger)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>    ranger<span class="sc">::</span><span class="fu">importance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>    <span class="fu">enframe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">as_factor</span>(name) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8"></a></span>
<span id="cb45-9"><a href="#cb45-9"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, name)) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ranger: Variable Importance"</span>,</span>
<span id="cb45-12"><a href="#cb45-12"></a>         <span class="at">subtitle =</span> <span class="st">"Model 05: Ranger Random Forest Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="Regression_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="randomforest---model-06" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="randomforest---model-06"><span class="header-section-number">7.3</span> randomForest - Model 06</h2>
<section id="model-7" class="level3">
<h3 class="anchored" data-anchor-id="model-7">Model</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-21_e78f93789c21ab2e650c0827b874629b">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># 4.2.3 Model randomForest ----</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>model_06_model <span class="ot">&lt;-</span> </span>
<span id="cb46-3"><a href="#cb46-3"></a>    <span class="fu">rand_forest</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>    <span class="fu">set_engine</span>(<span class="st">"randomForest"</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a>model_06_workflow <span class="ot">&lt;-</span> </span>
<span id="cb46-7"><a href="#cb46-7"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>  <span class="fu">add_model</span>(model_06_model) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a>model_06_rand_forest_randomForest <span class="ot">&lt;-</span> </span>
<span id="cb46-12"><a href="#cb46-12"></a>  model_06_workflow <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb46-14"><a href="#cb46-14"></a></span>
<span id="cb46-15"><a href="#cb46-15"></a>model_06_rand_forest_randomForest <span class="sc">%&gt;%</span> </span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">predict</span>(test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17"></a>  <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="#cb46-18"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"815.6440703"},{"1":"rsq","2":"standard","3":"0.8556875"},{"1":"mae","2":"standard","3":"621.8022220"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-explanation-5" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-5">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-22_5aeaff8affc10fe3955e16a434a2a7e5">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">pull_workflow_fit</span>(model_06_rand_forest_randomForest)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>    randomForest<span class="sc">::</span><span class="fu">importance</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>    <span class="co"># Convert matrix to tibble</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>    <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(IncNodePurity)) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">as_factor</span>(name) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7"></a></span>
<span id="cb47-8"><a href="#cb47-8"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(IncNodePurity, name)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>    <span class="fu">labs</span>(</span>
<span id="cb47-11"><a href="#cb47-11"></a>        <span class="at">title =</span> <span class="st">"randomForest: Variable Importance"</span>,</span>
<span id="cb47-12"><a href="#cb47-12"></a>        <span class="at">subtitle =</span> <span class="st">"Model 06: randomForest Model"</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="Regression_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model---xgboost" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="model---xgboost"><span class="header-section-number">7.4</span> Model - XGBoost</h2>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-23_3a946ed2fce87d2605dd3d0edd2b12de">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># 4.3 XGBOOST ----</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co"># 4.3.1 Model ----</span></span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a>model_07_model <span class="ot">&lt;-</span> </span>
<span id="cb48-5"><a href="#cb48-5"></a>    <span class="fu">boost_tree</span>(</span>
<span id="cb48-6"><a href="#cb48-6"></a>      <span class="at">mode =</span> <span class="st">"regression"</span>,</span>
<span id="cb48-7"><a href="#cb48-7"></a>      <span class="at">mtry =</span> <span class="dv">30</span>,</span>
<span id="cb48-8"><a href="#cb48-8"></a>      <span class="at">learn_rate =</span> <span class="fl">0.25</span>,</span>
<span id="cb48-9"><a href="#cb48-9"></a>      <span class="at">tree_depth =</span> <span class="dv">7</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>    <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>)</span>
<span id="cb48-12"><a href="#cb48-12"></a></span>
<span id="cb48-13"><a href="#cb48-13"></a>model_07_workflow <span class="ot">&lt;-</span> </span>
<span id="cb48-14"><a href="#cb48-14"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15"></a>  <span class="fu">add_model</span>(model_07_model) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16"></a>  <span class="fu">add_recipe</span>(bike_rec)</span>
<span id="cb48-17"><a href="#cb48-17"></a></span>
<span id="cb48-18"><a href="#cb48-18"></a>model_07_boost_tree_xgboost <span class="ot">&lt;-</span> </span>
<span id="cb48-19"><a href="#cb48-19"></a>  model_07_workflow <span class="sc">%&gt;%</span></span>
<span id="cb48-20"><a href="#cb48-20"></a>  <span class="fu">fit</span>(<span class="at">data =</span> train_tbl)</span>
<span id="cb48-21"><a href="#cb48-21"></a></span>
<span id="cb48-22"><a href="#cb48-22"></a>model_07_boost_tree_xgboost <span class="sc">%&gt;%</span> </span>
<span id="cb48-23"><a href="#cb48-23"></a>  <span class="fu">predict</span>(test_tbl) <span class="sc">%&gt;%</span></span>
<span id="cb48-24"><a href="#cb48-24"></a>  <span class="fu">bind_cols</span>(test_tbl <span class="sc">%&gt;%</span> <span class="fu">select</span>(price)) <span class="sc">%&gt;%</span></span>
<span id="cb48-25"><a href="#cb48-25"></a>  yardstick<span class="sc">::</span><span class="fu">metrics</span>(<span class="at">truth =</span> price, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".metric"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimate"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"rmse","2":"standard","3":"793.5125188"},{"1":"rsq","2":"standard","3":"0.8784088"},{"1":"mae","2":"standard","3":"617.7568048"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="model-explanation-6" class="level3">
<h3 class="anchored" data-anchor-id="model-explanation-6">Model Explanation</h3>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-24_466febee5499a209349b3a84e955bffb">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># 4.3.2 Feature Importance ----</span></span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="fu">pull_workflow_fit</span>(model_07_boost_tree_xgboost)<span class="sc">$</span>fit <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>    xgboost<span class="sc">::</span><span class="fu">xgb.importance</span>(<span class="at">model =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Gain)) <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7"></a>    <span class="fu">mutate</span>(<span class="at">Feature =</span> <span class="fu">as_factor</span>(Feature) <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8"></a></span>
<span id="cb49-9"><a href="#cb49-9"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(Gain, Feature)) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11"></a>    <span class="fu">labs</span>(</span>
<span id="cb49-12"><a href="#cb49-12"></a>        <span class="at">title =</span> <span class="st">"XGBoost: Variable Importance"</span>,</span>
<span id="cb49-13"><a href="#cb49-13"></a>        <span class="at">subtitle =</span> <span class="st">"Model 07: XGBoost Model"</span></span>
<span id="cb49-14"><a href="#cb49-14"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: `pull_workflow_fit()` was deprecated in workflows 0.2.3.
#&gt; ℹ Please use `extract_fit_parsnip()` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="Regression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="prediction-evaluation" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Prediction &amp; Evaluation</h1>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-25_78a36109caee135059097518cd599d25">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># 5.0 </span><span class="al">TESTING</span><span class="co"> THE ALGORITHMS OUT ----</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>g1 <span class="ot">&lt;-</span> bike_features_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a>    <span class="fu">mutate</span>(<span class="at">category_2 =</span> <span class="fu">as.factor</span>(category_2) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>           <span class="fu">fct_reorder</span>(price)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-5"><a href="#cb51-5"></a>    </span>
<span id="cb51-6"><a href="#cb51-6"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(category_2, price)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#2dc6d6"</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> frame_material) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12"></a>    <span class="fu">labs</span>(</span>
<span id="cb51-13"><a href="#cb51-13"></a>        <span class="at">title =</span> <span class="st">"Unit Price for Each Model"</span>,</span>
<span id="cb51-14"><a href="#cb51-14"></a>        <span class="at">y =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">"Category 2"</span></span>
<span id="cb51-15"><a href="#cb51-15"></a>    )</span>
<span id="cb51-16"><a href="#cb51-16"></a>g1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: Groups with fewer than two data points have been dropped.
#&gt; Groups with fewer than two data points have been dropped.
#&gt; Groups with fewer than two data points have been dropped.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Regression_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="Regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-26_b366709825f09f9914450126874bcd42">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># 5.1 NEW MODEL ----</span></span>
<span id="cb53-2"><a href="#cb53-2"></a></span>
<span id="cb53-3"><a href="#cb53-3"></a>new_cross_country <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-4"><a href="#cb53-4"></a>        <span class="at">id =</span> <span class="dv">0</span>,</span>
<span id="cb53-5"><a href="#cb53-5"></a>        <span class="at">model =</span> <span class="st">"Exceed AL SL new"</span>,</span>
<span id="cb53-6"><a href="#cb53-6"></a>        <span class="at">model_year =</span> <span class="dv">2022</span>,</span>
<span id="cb53-7"><a href="#cb53-7"></a>        <span class="at">frame_material =</span> <span class="st">"aluminium"</span>,</span>
<span id="cb53-8"><a href="#cb53-8"></a>        <span class="at">weight =</span> <span class="dv">10</span>,</span>
<span id="cb53-9"><a href="#cb53-9"></a>        <span class="at">category_1 =</span> <span class="st">"Mountain"</span>,</span>
<span id="cb53-10"><a href="#cb53-10"></a>        <span class="at">category_2 =</span> <span class="st">"Cross-Country"</span>,</span>
<span id="cb53-11"><a href="#cb53-11"></a>        <span class="at">category_3 =</span> <span class="st">"Exceed"</span>,</span>
<span id="cb53-12"><a href="#cb53-12"></a>        <span class="at">gender =</span> <span class="st">"unisex"</span>,</span>
<span id="cb53-13"><a href="#cb53-13"></a>        <span class="at">shimano_dura_ace =</span> <span class="dv">0</span>,</span>
<span id="cb53-14"><a href="#cb53-14"></a>        <span class="at">shimano_ultegra =</span> <span class="dv">0</span>,</span>
<span id="cb53-15"><a href="#cb53-15"></a>        <span class="at">shimano_105 =</span> <span class="dv">0</span>,</span>
<span id="cb53-16"><a href="#cb53-16"></a>        <span class="at">shimano_tiagra =</span> <span class="dv">0</span>,</span>
<span id="cb53-17"><a href="#cb53-17"></a>        <span class="at">Shimano_sora =</span> <span class="dv">0</span>,</span>
<span id="cb53-18"><a href="#cb53-18"></a>        <span class="at">shimano_deore =</span> <span class="dv">0</span>,</span>
<span id="cb53-19"><a href="#cb53-19"></a>        <span class="at">shimano_slx =</span> <span class="dv">0</span>,</span>
<span id="cb53-20"><a href="#cb53-20"></a>        <span class="at">shimano_grx =</span> <span class="dv">0</span>,</span>
<span id="cb53-21"><a href="#cb53-21"></a>        <span class="at">Shimano_xt =</span> <span class="dv">1</span>,</span>
<span id="cb53-22"><a href="#cb53-22"></a>        <span class="at">Shimano_xtr =</span> <span class="dv">0</span>,</span>
<span id="cb53-23"><a href="#cb53-23"></a>        <span class="at">Shimano_saint =</span> <span class="dv">0</span>,</span>
<span id="cb53-24"><a href="#cb53-24"></a>        <span class="at">SRAM_red =</span> <span class="dv">0</span>,</span>
<span id="cb53-25"><a href="#cb53-25"></a>        <span class="at">SRAM_force =</span> <span class="dv">0</span>,</span>
<span id="cb53-26"><a href="#cb53-26"></a>        <span class="at">SRAM_rival =</span> <span class="dv">0</span>,</span>
<span id="cb53-27"><a href="#cb53-27"></a>        <span class="at">SRAM_apex =</span> <span class="dv">0</span>,</span>
<span id="cb53-28"><a href="#cb53-28"></a>        <span class="at">SRAM_xx1 =</span> <span class="dv">0</span>,</span>
<span id="cb53-29"><a href="#cb53-29"></a>        <span class="at">SRAM_x01 =</span> <span class="dv">0</span>,</span>
<span id="cb53-30"><a href="#cb53-30"></a>        <span class="at">SRAM_gx =</span> <span class="dv">0</span>,</span>
<span id="cb53-31"><a href="#cb53-31"></a>        <span class="at">SRAM_nx =</span> <span class="dv">0</span>,</span>
<span id="cb53-32"><a href="#cb53-32"></a>        <span class="at">SRAM_sx =</span> <span class="dv">0</span>,</span>
<span id="cb53-33"><a href="#cb53-33"></a>        <span class="at">Campagnolo_potenza =</span> <span class="dv">0</span>,</span>
<span id="cb53-34"><a href="#cb53-34"></a>        <span class="at">Campagnolo_super_record =</span> <span class="dv">0</span>,</span>
<span id="cb53-35"><a href="#cb53-35"></a>        <span class="at">shimano_nexus =</span> <span class="dv">0</span>,</span>
<span id="cb53-36"><a href="#cb53-36"></a>        <span class="at">shimano_alfine =</span> <span class="dv">0</span></span>
<span id="cb53-37"><a href="#cb53-37"></a>) </span>
<span id="cb53-38"><a href="#cb53-38"></a></span>
<span id="cb53-39"><a href="#cb53-39"></a>new_cross_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["model"],"name":[2],"type":["chr"],"align":["left"]},{"label":["model_year"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["frame_material"],"name":[4],"type":["chr"],"align":["left"]},{"label":["weight"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["category_1"],"name":[6],"type":["chr"],"align":["left"]},{"label":["category_2"],"name":[7],"type":["chr"],"align":["left"]},{"label":["category_3"],"name":[8],"type":["chr"],"align":["left"]},{"label":["gender"],"name":[9],"type":["chr"],"align":["left"]},{"label":["shimano_dura_ace"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["shimano_ultegra"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["shimano_105"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["shimano_tiagra"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Shimano_sora"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["shimano_deore"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["shimano_slx"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["shimano_grx"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Shimano_xt"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["Shimano_xtr"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Shimano_saint"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["SRAM_red"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["SRAM_force"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["SRAM_rival"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["SRAM_apex"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["SRAM_xx1"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["SRAM_x01"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["SRAM_gx"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["SRAM_nx"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["SRAM_sx"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["Campagnolo_potenza"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["Campagnolo_super_record"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["shimano_nexus"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["shimano_alfine"],"name":[33],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"Exceed AL SL new","3":"2022","4":"aluminium","5":"10","6":"Mountain","7":"Cross-Country","8":"Exceed","9":"unisex","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"1","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="Regression_cache/html/unnamed-chunk-27_f8fa3335422360169d035dcce614a942">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>models_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb54-2"><a href="#cb54-2"></a>    <span class="at">model_id =</span> <span class="fu">str_c</span>(<span class="st">"Model 0"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb54-3"><a href="#cb54-3"></a>    <span class="at">model =</span> <span class="fu">list</span>(</span>
<span id="cb54-4"><a href="#cb54-4"></a>        model_01_linear_lm_simple,</span>
<span id="cb54-5"><a href="#cb54-5"></a>        model_02_linear_lm_complex,</span>
<span id="cb54-6"><a href="#cb54-6"></a>        model_03_linear_glmnet,</span>
<span id="cb54-7"><a href="#cb54-7"></a>        model_04_tree_decision_tree,</span>
<span id="cb54-8"><a href="#cb54-8"></a>        model_05_rand_forest_ranger,</span>
<span id="cb54-9"><a href="#cb54-9"></a>        model_06_rand_forest_randomForest,</span>
<span id="cb54-10"><a href="#cb54-10"></a>        model_07_boost_tree_xgboost</span>
<span id="cb54-11"><a href="#cb54-11"></a>    )</span>
<span id="cb54-12"><a href="#cb54-12"></a>)</span>
<span id="cb54-13"><a href="#cb54-13"></a></span>
<span id="cb54-14"><a href="#cb54-14"></a>models_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model"],"name":[2],"type":["list"],"align":["right"]}],"data":[{"1":"Model 01","2":"<S3: workflow>"},{"1":"Model 02","2":"<S3: workflow>"},{"1":"Model 03","2":"<S3: workflow>"},{"1":"Model 04","2":"<S3: workflow>"},{"1":"Model 05","2":"<S3: workflow>"},{"1":"Model 06","2":"<S3: workflow>"},{"1":"Model 07","2":"<S3: workflow>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># Add Predictions</span></span>
<span id="cb55-2"><a href="#cb55-2"></a></span>
<span id="cb55-3"><a href="#cb55-3"></a>predictions_new_cross_country_tbl <span class="ot">&lt;-</span> models_tbl <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>    <span class="fu">mutate</span>(<span class="at">predictions =</span> <span class="fu">map</span>(model, predict, <span class="at">new_data =</span> new_cross_country)) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>    <span class="fu">unnest</span>(predictions) <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>    <span class="fu">mutate</span>(<span class="at">category_2 =</span> <span class="st">"Cross-Country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7"></a>    <span class="fu">left_join</span>(new_cross_country, <span class="at">by =</span> <span class="st">"category_2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning: There were 2 warnings in `mutate()`.
#&gt; The first warning was:
#&gt; ℹ In argument: `predictions = map(model, predict, new_data =
#&gt;   new_cross_country)`.
#&gt; Caused by warning in `predict.lm()`:
#&gt; ! prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases
#&gt; ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>predictions_new_cross_country_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["model.x"],"name":[2],"type":["list"],"align":["right"]},{"label":[".pred_res"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".pred"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["category_2"],"name":[5],"type":["chr"],"align":["left"]},{"label":["id"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["model.y"],"name":[7],"type":["chr"],"align":["left"]},{"label":["model_year"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["frame_material"],"name":[9],"type":["chr"],"align":["left"]},{"label":["weight"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["category_1"],"name":[11],"type":["chr"],"align":["left"]},{"label":["category_3"],"name":[12],"type":["chr"],"align":["left"]},{"label":["gender"],"name":[13],"type":["chr"],"align":["left"]},{"label":["shimano_dura_ace"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["shimano_ultegra"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["shimano_105"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["shimano_tiagra"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Shimano_sora"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["shimano_deore"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["shimano_slx"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["shimano_grx"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["Shimano_xt"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["Shimano_xtr"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["Shimano_saint"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["SRAM_red"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["SRAM_force"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["SRAM_rival"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["SRAM_apex"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["SRAM_xx1"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["SRAM_x01"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["SRAM_gx"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["SRAM_nx"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["SRAM_sx"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["Campagnolo_potenza"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["Campagnolo_super_record"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["shimano_nexus"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["shimano_alfine"],"name":[37],"type":["dbl"],"align":["right"]}],"data":[{"1":"Model 01","2":"<S3: workflow>","3":"2688.84","4":"NA","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 02","2":"<S3: workflow>","3":"2688.84","4":"NA","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 03","2":"<S3: workflow>","3":"NA","4":"2674.657","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 04","2":"<S3: workflow>","3":"NA","4":"1182.077","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 05","2":"<S3: workflow>","3":"NA","4":"2017.277","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 06","2":"<S3: workflow>","3":"NA","4":"1526.958","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"},{"1":"Model 07","2":"<S3: workflow>","3":"NA","4":"1523.424","5":"Cross-Country","6":"0","7":"Exceed AL SL new","8":"2022","9":"aluminium","10":"10","11":"Mountain","12":"Exceed","13":"unisex","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"1","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","32":"0","33":"0","34":"0","35":"0","36":"0","37":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Congratulations! You are done with the 2nd challenge!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":true,"descPosition":"bottom"});</script>



</body></html>